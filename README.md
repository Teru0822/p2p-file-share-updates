# P2P File Share v2.3.0

IPMessenger風のLANベースP2Pファイル共有アプリケーション

## 🎯 主な機能

### ✅ 基本機能
- **自動デバイス検出**: 同じLAN内のデバイスを自動検出
- **PC名カスタマイズ**: 自由にPC名を編集・即時反映
- **複数選択送信**: チェックボックスで複数デバイスに一括送信
- **ドラッグ&ドロップ**: ファイルを直接ドロップして送信

### 📤 統合送信機能（v2.3.0 NEW!）
- **1つの送信ボタンで全対応**: テキスト・ファイル・両方を1つのボタンで送信
- **メッセージ + ファイル同時送信**: メッセージを添えてファイルを送れる
- **複数ファイル添付**: 複数のファイルを一度に送信可能
- **ドラッグ&ドロップ対応**: モーダル内でファイルを直接ドロップ

### 🔔 通知機能
- **受信音「ぴこん♪」**: メッセージ・ファイル受信時に通知音
- **Web Audio API**: 外部ファイル不要、軽量な通知音

### 🔄 自動アップデート
- **GitHub Pages連携**: 新バージョンを自動検出
- **ワンクリックアップデート**: 通知をクリックするだけで更新
- **自動再起動**: アップデート後は自動的にアプリ再起動

## 📥 使い方

### 基本的な送信

1. **デバイス一覧から送信先を選択**
2. **「📤 送信」ボタンをクリック**
3. **送信モーダルが開く**
   - メッセージを入力（任意）
   - ファイルを添付（任意）
   - または両方
4. **「送信」ボタンをクリック**

### 送信パターン

#### パターン1: メッセージのみ
```
テキスト入力欄: 「会議資料の確認お願いします」
ファイル添付: なし
→ 送信ボタン
```

#### パターン2: ファイルのみ
```
テキスト入力欄: 空欄
ファイル添付: 企画書.docx
→ 送信ボタン
```

#### パターン3: メッセージ + ファイル（おすすめ！）
```
テキスト入力欄: 「企画書を送ります。確認お願いします！」
ファイル添付: 企画書.docx、参考資料.pdf
→ 送信ボタン
```

### ファイル添付方法

**方法1**: 📎エリアをクリック → ファイル選択
**方法2**: ファイルを直接ドラッグ&ドロップ

添付したファイルは送信前に削除できます（×ボタン）

### 受信

1. **自動的に受信モーダルが開く**
2. **メッセージとファイルが表示される**
3. **各ファイルの「💾 保存」ボタンで個別保存**
4. **メッセージは「📋 コピー」でクリップボードにコピー可能**

## 🚀 インストール

### 必要環境
- Windows 10/11
- Node.js 18以上

### セットアップ

```bash
# 依存関係をインストール
npm install

# ファイアウォール設定（管理者権限で実行）
firewall-setup.bat

# アプリを起動
npm start
```

### ポータブル版のビルド

```bash
npm run build
```

実行ファイルは `dist/` フォルダに作成されます。

## 🔧 技術仕様

### ネットワーク
- **UDP 45678**: デバイス検出（ブロードキャスト）
- **TCP 45679**: メッセージ・ファイル転送

### データ形式

#### デバイス検出
```javascript
{
  type: 'announce',
  name: 'PC名',
  ip: '192.168.1.100'
}
```

#### メッセージ送信（テキスト+ファイル）
```javascript
{
  type: 'message',
  text: 'メッセージ本文',
  from: 'PC名',
  timestamp: 1234567890,
  fileCount: 2,
  files: [
    {
      name: 'file1.pdf',
      type: 'application/pdf',
      size: 524288,
      data: [バイナリデータ]
    },
    {
      name: 'file2.docx',
      type: 'application/vnd.openxmlformats...',
      size: 102400,
      data: [バイナリデータ]
    }
  ]
}
```

#### ファイルのみ送信（ドラッグ&ドロップ）
```javascript
{
  name: 'document.pdf',
  type: 'application/pdf',
  size: 1048576
}
```

## 🐛 トラブルシューティング

### デバイスが検出されない

1. **ファイアウォール設定**
   ```bash
   # 管理者権限で実行
   firewall-setup.bat
   ```

2. **同じサブネットか確認**
   ```bash
   ipconfig
   ```
   192.168.1.x と 192.168.2.x は別ネットワーク

3. **Wi-Fiのアイソレーション機能**
   ルーター設定で「APアイソレーション」を無効化

### メッセージが送信できない

1. **開発者ツール（起動時に自動で開く）でConsole確認**
2. **相手が起動しているか確認**
3. **pingテスト**
   ```bash
   ping <相手のIPアドレス>
   ```

### ファイルサイズ制限

- **推奨**: 1ファイル100MB以下
- **理論上**: メモリ次第（通常1GB程度まで）
- 大容量ファイルは複数回に分けて送信推奨

## 📊 バージョン履歴

### v2.3.0 (2025-12-21) - 現在
- ✨ **統合送信ボタン**: 「テキスト」ボタンを廃止し、「送信」ボタンに統合
- 📤 **メッセージ + ファイル同時送信**: 1つのモーダルで全て完結
- 📎 **複数ファイル添付対応**: 1度に複数ファイルを送信可能
- 🎨 **UI改善**: よりシンプルで直感的なインターフェース

### v2.2.1
- 🐛 sendText関数のnullエラー修正

### v2.2.0
- 🐛 テキスト送受信の完全修正
- 🐛 アップデート保存の完全修正
- 🔧 開発者ツール自動表示

### v2.1.4
- 💬 テキスト送信機能追加
- 🔔 受信通知音追加

### v2.0.0
- ✅ 初回リリース

## 🔐 セキュリティ

### 現在の実装
- ✅ ローカルネットワーク（LAN）内のみで動作
- ⚠️ 暗号化なし（平文通信）
- ⚠️ 認証機能なし

### 推奨環境
- ✅ 信頼できるネットワーク内でのみ使用
- ❌ 公衆Wi-Fiでは使用しない
- ⚠️ 機密情報の送信は避ける

## 📝 ライセンス

MIT License

---

**作成者**: Teru0822  
**バージョン**: 2.3.0  
**更新日**: 2025-12-21